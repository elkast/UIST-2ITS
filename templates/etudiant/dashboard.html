{% extends "base.html" %}

{% block title %}Tableau de Bord - Étudiant{% endblock %}

{% block nav_links %}
<li class="nav-item">
    <a class="nav-link active" href="{{ url_for('etudiant.dashboard') }}">
        <i class="bi bi-house"></i> Accueil
    </a>
</li>
<li class="nav-item">
    <a class="nav-link" href="{{ url_for('etudiant.emploi_temps') }}">
        <i class="bi bi-calendar3"></i> Emploi du Temps
    </a>
</li>
<li class="nav-item">
    <a class="nav-link" href="{{ url_for('etudiant.mes_notes') }}">
        <i class="bi bi-journal-text"></i> Mes Notes
    </a>
</li>
<li class="nav-item">
    <a class="nav-link" href="{{ url_for('etudiant.mes_bulletins') }}">
        <i class="bi bi-file-earmark-text"></i> Bulletins
    </a>
</li>
<li class="nav-item">
    <a class="nav-link" href="{{ url_for('etudiant.profil') }}">
        <i class="bi bi-person"></i> Profil
    </a>
</li>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- En-tête -->
    <div class="row mb-4">
        <div class="col">
            <h1 class="display-5 fw-bold">
                <i class="bi bi-mortarboard-fill text-primary"></i> Bienvenue, {{ infos.user.prenom }} !
            </h1>
            <p class="text-muted">{{ infos.filiere.nom_filiere }}</p>
        </div>
    </div>
    
    <!-- Statistiques Personnelles -->
    <div class="row g-4 mb-4">
        <div class="col-md-4">
            <div class="card stat-card stat-success">
                <div class="stat-value">{{ "%.2f"|format(moyenne) if moyenne else '-' }}</div>
                <div class="stat-label">Moyenne Générale</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stat-card stat-warning">
                <div class="stat-value">{{ rang if rang else '-' }}</div>
                <div class="stat-label">Classement</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stat-card">
                <div class="stat-value">{{ infos.user.matricule }}</div>
                <div class="stat-label">Matricule</div>
            </div>
        </div>
    </div>
    
    <!-- Prochain Cours -->
    {% if prochain_cours %}
    <div class="row mb-4">
        <div class="col">
            <div class="card border-primary">
                <div class="card-header bg-primary text-white">
                    <i class="bi bi-clock-fill"></i> Prochain Cours
                </div>
                <div class="card-body">
                    <h5 class="card-title">{{ prochain_cours.cours.libelle }}</h5>
                    <p class="card-text">
                        <i class="bi bi-calendar"></i> {{ prochain_cours.creneau.jour }}<br>
                        <i class="bi bi-clock"></i> {{ prochain_cours.creneau.heure_debut.strftime('%H:%M') }} - {{ prochain_cours.creneau.heure_fin.strftime('%H:%M') }}<br>
                        <i class="bi bi-geo-alt"></i> {{ prochain_cours.salle.nom_salle }}<br>
                        <i class="bi bi-person"></i> {{ prochain_cours.enseignant_nom }}
                    </p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Actions Rapides -->
    <div class="row">
        <div class="col">
            <div class="card">
                <div class="card-header">
                    <i class="bi bi-lightning-fill"></i> Accès Rapide
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-3">
                            <a href="{{ url_for('etudiant.emploi_temps') }}" class="btn btn-outline-primary w-100">
                                <i class="bi bi-calendar3"></i><br>
                                Emploi du Temps
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="{{ url_for('etudiant.mes_notes') }}" class="btn btn-outline-primary w-100">
                                <i class="bi bi-journal-text"></i><br>
                                Consulter Notes
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="{{ url_for('etudiant.mes_bulletins') }}" class="btn btn-outline-primary w-100">
                                <i class="bi bi-file-earmark-text"></i><br>
                                Mes Bulletins
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a href="{{ url_for('etudiant.profil') }}" class="btn btn-outline-secondary w-100">
                                <i class="bi bi-person"></i><br>
                                Mon Profil
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
